#!/bin/bash
# github.com/fl0at/dotfiles
# run a command (or ls, if not specified) recursively on directory components

if [ -z "$*" ]
then
	printf "usage: $0 path [[cmd] [arg1] ...]\n\nbreak apart and recursively call directory portions of a path, running [cmd] or 'ls -lhd' if unspecified"; exit 64 # exit status 64 is EX_USAGE
fi

TREE=`readlink -f $1`
shift
CMD=$@

(while [ "$TREE" != "/" ]
do
	${CMD:-ls -lhd --} $TREE
	TREE=`dirname $TREE`
done)|tac

exit 0
